import{_ as fl,r as f,v as ae,x as $,y as gl,z as _l,A as D,c as k,w as s,B as yl,a as xl,o as i,b as a,V as hl,C as u,d as bl,e as wl,D as kl,F as T,E as p,l as v,G as z,H as I,I as V,h as n,J as d,t as c,s as R,p as A,K as re,L as Se,f as U,M as se,N as P,O as B,P as G,k as N,Q as K,R as Ce,S as Sl,i as $e,T as De,U as Cl,g as Ue,m as $l,q as Le,W as Dl,X as Tl,Y as Vl,Z as Il}from"./index-CwATBQsK.js";import{u as Fl}from"./spaces-BkQHEJfU.js";import{T as zl,Q as Al,a as Re}from"./TaskActionSheet-CM6R4uCG.js";const Nl={class:"mb-4"},El={class:"d-flex align-center flex-wrap ga-2"},Ol={key:0,class:"mb-6"},Ml={key:1,class:"mb-6"},Ul={class:"d-flex align-center mb-3"},Ll={class:"d-flex align-center flex-wrap ga-2 mb-1"},Rl={key:0,class:"d-inline-flex align-center text-caption"},Pl={key:1,class:"d-inline-flex align-center text-caption"},Bl={class:"text-error text-caption"},Kl={key:0,class:"d-inline-flex align-center text-caption"},Jl={class:"d-inline-flex align-center text-caption"},Wl={class:"mb-6"},Zl={class:"d-flex align-center mb-3"},ql={class:"d-flex align-center flex-wrap ga-2 mb-1"},Hl={key:0,class:"d-inline-flex align-center text-caption"},Ql={key:1,class:"d-inline-flex align-center text-caption"},Gl={key:0,class:"d-inline-flex align-center text-caption"},Yl={key:1,class:"d-inline-flex align-center text-caption"},Xl={key:2,class:"mb-6"},jl={class:"d-flex align-center flex-wrap ga-2 mb-1"},et={key:0,class:"d-inline-flex align-center text-caption"},lt={key:1,class:"d-inline-flex align-center text-caption"},tt={class:"d-inline-flex align-center text-caption"},at={key:0,class:"d-inline-flex align-center text-caption"},st={class:"d-inline-flex align-center text-caption"},nt={class:"d-flex align-center flex-wrap ga-2 mb-1"},ot={key:0,class:"d-inline-flex align-center text-caption"},it={key:1,class:"d-inline-flex align-center text-caption"},rt={class:"d-inline-flex align-center text-caption"},ct={key:0,class:"d-inline-flex align-center text-caption"},ut={class:"d-inline-flex align-center text-caption"},dt={class:"d-flex align-center flex-wrap ga-2 mb-1"},pt={key:0,class:"d-inline-flex align-center text-caption"},mt={key:1,class:"d-inline-flex align-center text-caption"},vt={class:"d-inline-flex align-center text-caption"},ft={key:0,class:"d-inline-flex align-center text-caption"},gt={class:"d-inline-flex align-center text-caption"},_t={key:3,class:"mb-6"},yt={class:"d-flex align-center flex-wrap ga-2 mb-1"},xt={key:0,class:"d-inline-flex align-center text-caption"},ht={key:1,class:"d-inline-flex align-center text-caption"},bt={class:"text-body-2 text-medium-emphasis mb-3"},wt={class:"d-flex flex-wrap ga-2 mb-4"},kt={class:"d-flex align-center"},St={key:0,class:"ml-8 mt-2"},Ct={key:0,class:"text-caption text-medium-emphasis"},$t={__name:"DashboardView",setup(Dt){const Pe=xl(),b=Fl(),Be=_l(),ce=f(!1),x=f([]),F=f([]),E=f(!1),ne=f(!1),ue=f(!1),de=f(!1),Te=f(null),pe=f(null),Ve=f(null),Ie=f(""),oe=f(!1),J=f(!1),W=f(""),m=f(null),Fe=f(navigator.onLine),Y=f(localStorage.getItem("dashboard-upcoming-expanded")==="true"),X=f(localStorage.getItem("dashboard-inactive-expanded")==="true"),j=f(localStorage.getItem("dashboard-inbox-expanded")!=="false"),g=f(!1),_=f(""),y=f("success"),O=f(2e3),M=f(!1),ee=f(null);window.addEventListener("online",()=>{Fe.value=!0}),window.addEventListener("offline",()=>{Fe.value=!1});const h=f([]),w=f([]);function Ke(){const t=localStorage.getItem("dashboard-space-filter");if(t)try{h.value=JSON.parse(t)}catch{h.value=[]}else h.value=b.spaces.map(e=>e.id)}function me(){localStorage.setItem("dashboard-space-filter",JSON.stringify(h.value))}function ze(t){const e=h.value.indexOf(t);e===-1?h.value.push(t):h.value.splice(e,1),me()}ae(h,me,{deep:!0}),ae(Y,t=>localStorage.setItem("dashboard-upcoming-expanded",t)),ae(X,t=>localStorage.setItem("dashboard-inactive-expanded",t)),ae(j,t=>localStorage.setItem("dashboard-inbox-expanded",t));function Je(){const t=localStorage.getItem("dashboard-category-filter");if(t)try{w.value=JSON.parse(t)}catch{w.value=[]}else w.value=F.value.map(e=>e.id)}function ve(){localStorage.setItem("dashboard-category-filter",JSON.stringify(w.value))}function We(t){const e=w.value.indexOf(t);e===-1?w.value.push(t):w.value.splice(e,1),ve()}ae(w,ve,{deep:!0}),$(()=>h.value.length===0?F.value:F.value.filter(t=>h.value.includes(t.space_id)));function Ae(t){return F.value.filter(e=>e.space_id===t)}const Ze=$(()=>{const t=h.value.length===b.spaces.length,e=w.value.length===F.value.length;return!t||!e});function qe(){h.value=b.spaces.map(t=>t.id),w.value=F.value.map(t=>t.id),me(),ve()}const L=$(()=>{let t=x.value.filter(e=>e.status==="active"&&e.task_type!=="inbox");return h.value.length>0&&(t=t.filter(e=>h.value.includes(e.space_id))),w.value.length>0&&(t=t.filter(e=>!e.category_id||w.value.includes(e.category_id))),t}),fe=$(()=>x.value.filter(t=>t.task_type==="inbox"&&t.status==="active"));function He(t){switch(t){case"voice":return"mdi-microphone";case"manual":return"mdi-keyboard";default:return"mdi-inbox"}}function Qe(t){switch(t){case"voice":return"info";case"manual":return"grey";default:return"grey"}}async function Ge(t){try{await D.post(`/spaces/${t.space_id}/tasks/${t.id}/complete`,{}),x.value=x.value.filter(e=>!(e.space_id===t.space_id&&e.id===t.id)),_.value=`Erledigt: ${t.title}`,y.value="success",g.value=!0}catch(e){console.error("Failed to complete inbox item:",e),_.value="Fehler beim Erledigen",y.value="error",g.value=!0}}function Ye(t){var e,o;m.value=t,ne.value=!0,(o=(e=pe.value)==null?void 0:e.focusInputNow)==null||o.call(e)}async function Xe(t){try{await D.delete(`/spaces/${t.space_id}/tasks/${t.id}`),x.value=x.value.filter(e=>!(e.space_id===t.space_id&&e.id===t.id)),_.value="Inbox-Eintrag gelöscht",y.value="success",g.value=!0}catch(e){console.error("Failed to delete inbox item:",e),_.value="Fehler beim Löschen",y.value="error",g.value=!0}}const ge=$(()=>{let t=x.value.filter(e=>e.status==="inactive");return h.value.length>0&&(t=t.filter(e=>h.value.includes(e.space_id))),w.value.length>0&&(t=t.filter(e=>!e.category_id||w.value.includes(e.category_id))),t});function le(t){return t.sort((e,o)=>!e.has_specific_time&&o.has_specific_time?-1:e.has_specific_time&&!o.has_specific_time?1:e.has_specific_time&&o.has_specific_time?e.time_of_day.localeCompare(o.time_of_day):0)}$(()=>{const t=new Date().toISOString().split("T")[0];return L.value.filter(e=>e.has_specific_time&&e.next_due_date===t).sort((e,o)=>e.time_of_day.localeCompare(o.time_of_day))});const _e=$(()=>{const t=L.value.filter(e=>e.is_overdue&&!Ee(e));return le(t)}),ye=$(()=>{const t=new Date().toISOString().split("T")[0],e=L.value.filter(o=>o.task_type==="one_time"&&!o.next_due_date&&!o.is_overdue?!0:!o.is_overdue&&o.next_due_date===t&&!Ee(o));return le(e)}),xe=$(()=>{const t=new Date,e=new Date(t);e.setDate(e.getDate()+1);const o=e.toISOString().split("T")[0],l=L.value.filter(r=>r.next_due_date===o);return le(l)}),he=$(()=>{const t=new Date,e=new Date(t);e.setDate(e.getDate()+1);const o=new Date(t);o.setDate(o.getDate()+7);const l=e.toISOString().split("T")[0],r=o.toISOString().split("T")[0],S=L.value.filter(C=>C.next_due_date>l&&C.next_due_date<=r);return le(S)}),be=$(()=>{const t=new Date,e=new Date(t);e.setDate(e.getDate()+7);const o=e.toISOString().split("T")[0],l=L.value.filter(r=>r.next_due_date>o);return le(l)}),Ne=$(()=>{const t=new Date().toISOString().split("T")[0];return L.value.filter(e=>e.next_due_date>t)});function Ee(t){const e=new Date().toISOString().split("T")[0];return t.has_specific_time&&t.next_due_date===e}function je(t){return t<=1?"#FFCDD2":t<=2?"#EF9A9A":t<=3?"#E57373":t<=5?"#EF5350":"#D32F2F"}function el(t){return t<=2?"#000000":"#FFFFFF"}const Z=$(()=>b.spaces.length===0?null:b.spaces[0].id);$(()=>Z.value?F.value.filter(t=>t.space_id===Z.value):[]);function Oe(){var t,e;de.value=!0,(e=(t=Te.value)==null?void 0:t.focusInputNow)==null||e.call(t)}async function ll(t){const e=t.space_id||Z.value;if(!e){_.value="Kein Space verfügbar",y.value="error",g.value=!0;return}try{const o=await D.post(`/spaces/${e}/tasks`,{title:t.title,task_type:"inbox"});await q(),_.value="Zur Inbox hinzugefügt",y.value="success",O.value=2e3,M.value=!1,g.value=!0}catch(o){console.error("Failed to add to inbox:",o),_.value="Fehler beim Hinzufügen",y.value="error",g.value=!0}}function tl(t){var e,o;Ie.value=t||"",ue.value=!0,(o=(e=Ve.value)==null?void 0:e.focusInputNow)==null||o.call(e)}gl(async()=>{await q(),Ke(),Je(),Be.on("dashboard:refresh",q)});async function q(){ce.value=!0;try{await b.fetchSpaces();const t=b.spaces.map(async r=>{try{return(await D.get(`/spaces/${r.id}/tasks`)).tasks.map(C=>({...C,space_id:r.id,space_name:r.personal_name||r.name,space_color:r.personal_color}))}catch(S){return console.error(`Failed to fetch tasks for space ${r.id}:`,S),[]}}),e=b.spaces.map(async r=>{try{return(await D.get(`/spaces/${r.id}/categories`)).categories.map(C=>({...C,space_id:r.id}))}catch{return[]}}),[o,l]=await Promise.all([Promise.all(t),Promise.all(e)]);x.value=o.flat(),F.value=l.flat()}finally{ce.value=!1}}function H(t){m.value=t,E.value=!0}async function Q(t){var e,o;try{const l=x.value.findIndex(C=>C.space_id===t.space_id&&C.id===t.id);l!==-1&&(x.value[l]={...x.value[l],completing:!0}),await new Promise(C=>setTimeout(C,500));const r=await D.post(`/spaces/${t.space_id}/tasks/${t.id}/complete`,{});((e=r.task)==null?void 0:e.status)==="completed"||((o=r.task)==null?void 0:o.task_type)==="inbox"?x.value=x.value.filter(C=>!(C.space_id===t.space_id&&C.id===t.id)):r.task&&l!==-1&&(x.value[l]={...r.task,space_id:t.space_id,space_name:t.space_name,space_color:t.space_color}),_.value=`Erledigt: ${t.title}`,y.value="success",g.value=!0}catch(l){console.error("Failed to complete task:",l),_.value="Fehler beim Erledigen",y.value="error",g.value=!0}}async function al(){await Q(m.value),E.value=!1}async function sl(){try{const t=await D.post(`/spaces/${m.value.space_id}/tasks/${m.value.id}/skip`,{}),e=x.value.findIndex(o=>o.space_id===m.value.space_id&&o.id===m.value.id);e!==-1&&(x.value[e]={...t.task,space_id:m.value.space_id,space_name:m.value.space_name,space_color:m.value.space_color}),E.value=!1,_.value="Aufgabe übersprungen",y.value="success",g.value=!0}catch(t){console.error("Failed to skip task:",t),_.value="Fehler beim Überspringen",y.value="error",g.value=!0}}function nl(){W.value="",E.value=!1,J.value=!0}function Me(t){if(!t)return"Kein Datum";const[e,o,l]=t.split("-").map(Number),r=new Date(e,o-1,l);return`${["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"][r.getDay()]}, ${r.getDate()}.${r.getMonth()+1}.${r.getFullYear()}`}async function we(t){await ie({days:t})}async function ol(){const t=new Date;t.setDate(t.getDate()+1),await ie({new_date:t.toISOString().split("T")[0]})}async function il(){const t=new Date;t.setDate(t.getDate()+7),await ie({new_date:t.toISOString().split("T")[0]})}async function rl(){W.value&&await ie({new_date:W.value})}async function ie(t){try{const e=await D.post(`/spaces/${m.value.space_id}/tasks/${m.value.id}/postpone`,t),o=x.value.findIndex(l=>l.space_id===m.value.space_id&&l.id===m.value.id);o!==-1&&(x.value[o]={...e.task,space_id:m.value.space_id,space_name:m.value.space_name,space_color:m.value.space_color}),J.value=!1,_.value=`Verschoben auf ${Me(e.next_due_date)}`,y.value="success",g.value=!0}catch(e){console.error("Failed to postpone task:",e),_.value="Fehler beim Verschieben",y.value="error",g.value=!0}}function cl(){var t,e;E.value=!1,ne.value=!0,(e=(t=pe.value)==null?void 0:t.focusInputNow)==null||e.call(t)}async function ul(t){try{const e=m.value.space_id,o=t.space_id;o&&o!==e?(await D.post(`/spaces/${o}/tasks`,t),await D.delete(`/spaces/${e}/tasks/${m.value.id}`)):await D.patch(`/spaces/${e}/tasks/${m.value.id}`,t),await q(),_.value="Aufgabe aktualisiert",y.value="success",g.value=!0}catch(e){console.error("Failed to save task:",e),_.value="Fehler beim Speichern",y.value="error",g.value=!0}}async function dl(t){const e=t.space_id||Z.value;if(!e){_.value="Kein Space verfügbar",y.value="error",O.value=2e3,M.value=!1,g.value=!0;return}try{const o=await D.post(`/spaces/${e}/tasks`,t);await q(),ee.value={id:o.task.id,space_id:e},_.value=`Erstellt: ${t.title}`,y.value="success",O.value=4e3,M.value=!0,g.value=!0}catch(o){console.error("Failed to create task:",o),_.value="Fehler beim Erstellen",y.value="error",O.value=2e3,M.value=!1,g.value=!0}}function ke(t){if(!t.next_due_date)return"";const[e,o,l]=t.next_due_date.split("-").map(Number),r=new Date(e,o-1,l);return`${["So","Mo","Di","Mi","Do","Fr","Sa"][r.getDay()]}, ${r.getDate()}.${r.getMonth()+1}.`}function te(t){if(t.task_type==="inbox")return"Inbox";if(t.task_type==="one_time")return t.next_due_date?"Einmalig":"Ohne Datum";if(t.recurrence_type==="interval"){const e=t.interval_days||1;return`Alle ${e} Tag${e>1?"e":""}`}if(t.recurrence_type==="schedule")try{const e=JSON.parse(t.schedule_pattern);if(e.type==="weekly")return"Wöchentlich";if(e.type==="monthly")return"Monatlich"}catch{return"Zeitplan"}return"Wiederholend"}function pl(){E.value=!1,Pe.push("/history")}async function ml(){if(confirm(`Möchten Sie die Aufgabe "${m.value.title}" wirklich löschen?`))try{await D.delete(`/spaces/${m.value.space_id}/tasks/${m.value.id}`),x.value=x.value.filter(t=>!(t.space_id===m.value.space_id&&t.id===m.value.id)),E.value=!1,_.value="Aufgabe gelöscht",y.value="success",O.value=2e3,M.value=!1,g.value=!0}catch(t){console.error("Failed to delete task:",t),_.value="Fehler beim Löschen",y.value="error",O.value=2e3,M.value=!1,g.value=!0}}async function vl(){if(ee.value)try{await D.delete(`/spaces/${ee.value.space_id}/tasks/${ee.value.id}`),await q(),ee.value=null,g.value=!1}catch(t){console.error("Failed to undo:",t),_.value="Rückgängig fehlgeschlagen",y.value="error",O.value=2e3,M.value=!1,g.value=!0}}return(t,e)=>(i(),k(yl,{class:"bg-background"},{default:s(()=>{var o;return[a(hl,{fluid:"",class:"pa-4"},{default:s(()=>[ce.value?(i(),k(bl,{key:0},{default:s(()=>[a(wl,{cols:"12",class:"text-center py-8"},{default:s(()=>[a(kl,{indeterminate:"",color:"primary"})]),_:1})]),_:1})):(i(),u(T,{key:1},[p("div",Nl,[p("div",El,[(i(!0),u(T,null,z(I(b).spaces,l=>(i(),k(V,{key:l.id,variant:h.value.includes(l.id)?"flat":"outlined",color:h.value.includes(l.id)?l.personal_color||"primary":"",onClick:r=>ze(l.id),size:"small"},{default:s(()=>[a(d,{icon:"mdi-folder",size:"small",class:"mr-1"}),n(" "+c(l.personal_name||l.name),1)]),_:2},1032,["variant","color","onClick"]))),128)),a(R),a(A,{icon:"mdi-filter-variant",size:"small",variant:"text",color:Ze.value?"error":void 0,onClick:e[0]||(e[0]=l=>oe.value=!0)},null,8,["color"])])]),fe.value.length>0?(i(),u("div",Ol,[p("div",{class:"d-flex align-center mb-3 cursor-pointer",onClick:e[1]||(e[1]=l=>j.value=!j.value)},[a(d,{icon:"mdi-inbox",color:"info",class:"mr-2"}),e[18]||(e[18]=p("h2",{class:"text-h6 font-weight-bold text-info"},"Inbox",-1)),a(V,{size:"small",color:"info",class:"ml-2"},{default:s(()=>[n(c(fe.value.length),1)]),_:1}),a(R),a(d,{icon:j.value?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"])]),a(re,null,{default:s(()=>[Se(a(U,{elevation:"0"},{default:s(()=>[a(se,{class:"pa-0",lines:"two"},{default:s(()=>[(i(!0),u(T,null,z(fe.value,l=>(i(),k(P,{key:`${l.space_id}-${l.id}`,class:"px-4 py-3"},{prepend:s(()=>[a(K,{"model-value":!1,onClick:N(r=>Ge(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-2"},null,8,["onClick"])]),append:s(()=>[a(A,{icon:"mdi-arrow-right-bold",variant:"text",size:"small",color:"primary",onClick:N(r=>Ye(l),["stop"]),title:"Zur Aufgabe machen"},null,8,["onClick"]),a(A,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:N(r=>Xe(l),["stop"])},null,8,["onClick"])]),default:s(()=>[a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title)+" ",1),a(d,{icon:He(l.inbox_type),color:Qe(l.inbox_type),size:"xs",class:"mr-2"},null,8,["icon","color"])]),_:2},1024),l.transcript&&l.transcript!==l.title?(i(),k(G,{key:0,class:"text-caption mt-1"},{default:s(()=>[n(c(l.transcript.substring(0,150))+c(l.transcript.length>150?"...":""),1)]),_:2},1024)):v("",!0)]),_:2},1024))),128))]),_:1})]),_:1},512),[[Ce,j.value]])]),_:1})])):v("",!0),_e.value.length>0?(i(),u("div",Ml,[p("div",Ul,[a(d,{icon:"mdi-alert-circle",color:"error",class:"mr-2"}),e[19]||(e[19]=p("h2",{class:"text-h6 font-weight-bold text-error"},"Überfällig",-1)),a(V,{size:"small",color:"error",class:"ml-2"},{default:s(()=>[n(c(_e.value.length),1)]),_:1})]),a(U,{elevation:"0"},{default:s(()=>[a(se,{class:"pa-0",lines:"two"},{default:s(()=>[(i(!0),u(T,null,z(_e.value,(l,r)=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:S=>H(l),class:"px-4 py-3",style:Sl({backgroundColor:je(l.days_overdue),color:el(l.days_overdue)})},{prepend:s(()=>[a(K,{"model-value":l.completing||!1,onClick:N(S=>Q(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-4"},null,8,["model-value","onClick"])]),default:s(()=>[p("div",Ll,[I(b).spaces.length>1?(i(),u("span",Rl,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",Pl,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024),a(G,{class:"d-flex align-center flex-wrap ga-2 mt-1"},{default:s(()=>[p("span",Bl,c(l.days_overdue)+"d überfällig",1),l.has_specific_time?(i(),u("span",Kl,[a(d,{icon:"mdi-clock-outline",size:"small",class:"mr-1"}),n(" "+c(l.time_of_day),1)])):v("",!0),p("span",Jl,[a(d,{icon:"mdi-refresh",size:"small",class:"mr-1"}),n(" "+c(te(l)),1)])]),_:2},1024)]),_:2},1032,["onClick","style"]))),128))]),_:1})]),_:1})])):v("",!0),p("div",Wl,[p("div",Zl,[a(d,{icon:"mdi-calendar-today",color:"warning",class:"mr-2"}),e[20]||(e[20]=p("h2",{class:"text-h6 font-weight-bold"},"Heute",-1)),a(V,{size:"small",color:"warning",class:"ml-2"},{default:s(()=>[n(c(ye.value.length),1)]),_:1})]),ye.value.length>0?(i(),k(U,{key:0,elevation:"0"},{default:s(()=>[a(se,{class:"pa-0",lines:"two"},{default:s(()=>[(i(!0),u(T,null,z(ye.value,(l,r)=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:S=>H(l),class:"px-4 py-3"},{prepend:s(()=>[a(K,{"model-value":l.completing||!1,onClick:N(S=>Q(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-4"},null,8,["model-value","onClick"])]),default:s(()=>[p("div",ql,[I(b).spaces.length>1?(i(),u("span",Hl,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",Ql,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024),l.has_specific_time||l.task_type==="recurring"?(i(),k(G,{key:0,class:"d-flex align-center flex-wrap ga-2 mt-1"},{default:s(()=>[l.has_specific_time?(i(),u("span",Gl,[a(d,{icon:"mdi-clock-outline",size:"small",class:"mr-1"}),n(" "+c(l.time_of_day),1)])):v("",!0),l.task_type==="recurring"?(i(),u("span",Yl,[a(d,{icon:"mdi-refresh",size:"small",class:"mr-1"}),n(" "+c(te(l)),1)])):v("",!0)]),_:2},1024)):v("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):(i(),k(U,{key:1,elevation:"0"},{default:s(()=>[a($e,{class:"text-center py-8"},{default:s(()=>[a(d,{size:"48",color:"grey-lighten-1"},{default:s(()=>[...e[21]||(e[21]=[n("mdi-check-circle-outline",-1)])]),_:1}),e[22]||(e[22]=p("div",{class:"text-body-2 text-medium-emphasis mt-2"}," Keine Aufgaben für heute ",-1))]),_:1})]),_:1}))]),Ne.value.length>0?(i(),u("div",Xl,[p("div",{class:"d-flex align-center mb-3 cursor-pointer",onClick:e[2]||(e[2]=l=>Y.value=!Y.value)},[a(d,{icon:"mdi-calendar-clock",class:"mr-2"}),e[23]||(e[23]=p("h2",{class:"text-h6 font-weight-bold"},"Demnächst",-1)),a(V,{size:"small",variant:"outlined",class:"ml-2"},{default:s(()=>[n(c(Ne.value.length),1)]),_:1}),a(R),a(d,{icon:Y.value?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"])]),a(re,null,{default:s(()=>[Se(a(U,{elevation:"0"},{default:s(()=>[a(se,{class:"pa-0",lines:"two"},{default:s(()=>[xe.value.length>0?(i(),u(T,{key:0},[a(De,{class:"px-4"},{default:s(()=>[e[24]||(e[24]=n(" Morgen ",-1)),a(V,{size:"x-small",class:"ml-2"},{default:s(()=>[n(c(xe.value.length),1)]),_:1})]),_:1}),(i(!0),u(T,null,z(xe.value,l=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:r=>H(l),class:"px-4 py-3"},{prepend:s(()=>[a(K,{"model-value":!1,onClick:N(r=>Q(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-4"},null,8,["onClick"])]),default:s(()=>[p("div",jl,[I(b).spaces.length>1?(i(),u("span",et,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",lt,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024),a(G,{class:"d-flex align-center flex-wrap ga-2 mt-1"},{default:s(()=>[p("span",tt,[a(d,{icon:"mdi-calendar",size:"small",class:"mr-1"}),n(" "+c(ke(l)),1)]),l.has_specific_time?(i(),u("span",at,[a(d,{icon:"mdi-clock-outline",size:"small",class:"mr-1"}),n(" "+c(l.time_of_day),1)])):v("",!0),p("span",st,[a(d,{icon:"mdi-refresh",size:"small",class:"mr-1"}),n(" "+c(te(l)),1)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))],64)):v("",!0),he.value.length>0?(i(),u(T,{key:1},[a(De,{class:"px-4"},{default:s(()=>[e[25]||(e[25]=n(" Nächste 7 Tage ",-1)),a(V,{size:"x-small",class:"ml-2"},{default:s(()=>[n(c(he.value.length),1)]),_:1})]),_:1}),(i(!0),u(T,null,z(he.value,l=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:r=>H(l),class:"px-4 py-3"},{prepend:s(()=>[a(K,{"model-value":!1,onClick:N(r=>Q(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-4"},null,8,["onClick"])]),default:s(()=>[p("div",nt,[I(b).spaces.length>1?(i(),u("span",ot,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",it,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024),a(G,{class:"d-flex align-center flex-wrap ga-2 mt-1"},{default:s(()=>[p("span",rt,[a(d,{icon:"mdi-calendar",size:"small",class:"mr-1"}),n(" "+c(ke(l)),1)]),l.has_specific_time?(i(),u("span",ct,[a(d,{icon:"mdi-clock-outline",size:"small",class:"mr-1"}),n(" "+c(l.time_of_day),1)])):v("",!0),p("span",ut,[a(d,{icon:"mdi-refresh",size:"small",class:"mr-1"}),n(" "+c(te(l)),1)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))],64)):v("",!0),be.value.length>0?(i(),u(T,{key:2},[a(De,{class:"px-4"},{default:s(()=>[e[26]||(e[26]=n(" Später ",-1)),a(V,{size:"x-small",class:"ml-2"},{default:s(()=>[n(c(be.value.length),1)]),_:1})]),_:1}),(i(!0),u(T,null,z(be.value,l=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:r=>H(l),class:"px-4 py-3"},{prepend:s(()=>[a(K,{"model-value":!1,onClick:N(r=>Q(l),["stop"]),"hide-details":"",color:"success",density:"compact",class:"mr-4"},null,8,["onClick"])]),default:s(()=>[p("div",dt,[I(b).spaces.length>1?(i(),u("span",pt,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",mt,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024),a(G,{class:"d-flex align-center flex-wrap ga-2 mt-1"},{default:s(()=>[p("span",vt,[a(d,{icon:"mdi-calendar",size:"small",class:"mr-1"}),n(" "+c(ke(l)),1)]),l.has_specific_time?(i(),u("span",ft,[a(d,{icon:"mdi-clock-outline",size:"small",class:"mr-1"}),n(" "+c(l.time_of_day),1)])):v("",!0),p("span",gt,[a(d,{icon:"mdi-refresh",size:"small",class:"mr-1"}),n(" "+c(te(l)),1)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))],64)):v("",!0)]),_:1})]),_:1},512),[[Ce,Y.value]])]),_:1})])):v("",!0),ge.value.length>0?(i(),u("div",_t,[p("div",{class:"d-flex align-center mb-3 cursor-pointer",onClick:e[3]||(e[3]=l=>X.value=!X.value)},[a(d,{icon:"mdi-pause-circle-outline",class:"mr-2"}),e[27]||(e[27]=p("h2",{class:"text-h6 font-weight-bold"},"Inaktiv",-1)),a(V,{size:"small",variant:"outlined",class:"ml-2"},{default:s(()=>[n(c(ge.value.length),1)]),_:1}),a(R),a(d,{icon:X.value?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"])]),a(re,null,{default:s(()=>[Se(a(U,{elevation:"0"},{default:s(()=>[a(se,{class:"pa-0",lines:"two"},{default:s(()=>[(i(!0),u(T,null,z(ge.value,l=>(i(),k(P,{key:`${l.space_id}-${l.id}`,onClick:r=>H(l),class:"px-4 py-3"},{default:s(()=>[p("div",yt,[I(b).spaces.length>1?(i(),u("span",xt,[a(d,{icon:"mdi-folder",size:"small",class:"mr-1",color:l.space_color||"grey"},null,8,["color"]),n(" "+c(l.space_name),1)])):v("",!0),l.category?(i(),u("span",ht,[a(d,{icon:l.category.icon||"mdi-tag",color:l.category.color,size:"small",class:"mr-1"},null,8,["icon","color"]),n(" "+c(l.category.name),1)])):v("",!0)]),a(B,{class:"text-body-1 font-weight-medium"},{default:s(()=>[n(c(l.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},512),[[Ce,X.value]])]),_:1})])):v("",!0),e[28]||(e[28]=p("div",{style:{height:"32px"}},null,-1))],64)),a(A,{icon:"mdi-plus",color:"primary",size:"large",position:"fixed",location:"bottom end",class:"mb-16 me-4",onPointerdown:N(Oe,["prevent"]),onTouchstart:N(Oe,["prevent"])})]),_:1}),a(zl,{modelValue:E.value,"onUpdate:modelValue":e[4]||(e[4]=l=>E.value=l),task:m.value,"show-space-name":I(b).spaces.length>1,onComplete:al,onSkip:sl,onPostpone:nl,onEdit:cl,onHistory:pl,onDelete:ml},null,8,["modelValue","task","show-space-name"]),a(Cl,{modelValue:J.value,"onUpdate:modelValue":e[11]||(e[11]=l=>J.value=l)},{default:s(()=>[m.value?(i(),k(U,{key:0},{default:s(()=>[a(Ue,{class:"d-flex align-center"},{default:s(()=>[a(d,{icon:"mdi-calendar-clock",class:"mr-2"}),e[29]||(e[29]=p("span",null,"Verschieben",-1)),a(R),a(A,{icon:"mdi-close",variant:"text",onClick:e[5]||(e[5]=l=>J.value=!1)})]),_:1}),a($e,null,{default:s(()=>[p("div",bt," Aktuell fällig: "+c(Me(m.value.next_due_date)),1),p("div",wt,[a(V,{onClick:e[6]||(e[6]=l=>we(1)),variant:"outlined"},{default:s(()=>[...e[30]||(e[30]=[n("+1 Tag",-1)])]),_:1}),a(V,{onClick:e[7]||(e[7]=l=>we(2)),variant:"outlined"},{default:s(()=>[...e[31]||(e[31]=[n("+2 Tage",-1)])]),_:1}),a(V,{onClick:e[8]||(e[8]=l=>we(3)),variant:"outlined"},{default:s(()=>[...e[32]||(e[32]=[n("+3 Tage",-1)])]),_:1}),a(V,{onClick:ol,variant:"outlined"},{default:s(()=>[...e[33]||(e[33]=[n("Morgen",-1)])]),_:1}),a(V,{onClick:il,variant:"outlined"},{default:s(()=>[...e[34]||(e[34]=[n("Nächste Woche",-1)])]),_:1})]),a($l,{modelValue:W.value,"onUpdate:modelValue":e[9]||(e[9]=l=>W.value=l),label:"Anderes Datum",type:"date",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),a(Le,null,{default:s(()=>[a(A,{variant:"text",onClick:e[10]||(e[10]=l=>J.value=!1)},{default:s(()=>[...e[35]||(e[35]=[n("Abbrechen",-1)])]),_:1}),a(R),a(A,{variant:"text",color:"primary",disabled:!W.value,onClick:rl},{default:s(()=>[...e[36]||(e[36]=[n(" Verschieben ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):v("",!0)]),_:1},8,["modelValue"]),a(Al,{ref_key:"quickAddRef",ref:Te,modelValue:de.value,"onUpdate:modelValue":e[12]||(e[12]=l=>de.value=l),"default-space-id":Z.value,onAddInbox:ll,onOpenFull:tl},null,8,["modelValue","default-space-id"]),a(Re,{ref_key:"editDialogRef",ref:pe,modelValue:ne.value,"onUpdate:modelValue":e[13]||(e[13]=l=>ne.value=l),task:m.value,categories:F.value,spaces:I(b).spaces,"default-space-id":(o=m.value)==null?void 0:o.space_id,onSave:ul},null,8,["modelValue","task","categories","spaces","default-space-id"]),a(Re,{ref_key:"createDialogRef",ref:Ve,modelValue:ue.value,"onUpdate:modelValue":e[14]||(e[14]=l=>ue.value=l),categories:F.value,spaces:I(b).spaces,"default-space-id":Z.value,"initial-title":Ie.value,onSave:dl},null,8,["modelValue","categories","spaces","default-space-id","initial-title"]),a(Dl,{modelValue:g.value,"onUpdate:modelValue":e[15]||(e[15]=l=>g.value=l),timeout:O.value,color:y.value,location:"top"},Tl({default:s(()=>[n(c(_.value)+" ",1)]),_:2},[M.value?{name:"actions",fn:s(()=>[a(A,{icon:"mdi-undo",variant:"text",onClick:vl})]),key:"0"}:void 0]),1032,["modelValue","timeout","color"]),a(Vl,{modelValue:oe.value,"onUpdate:modelValue":e[17]||(e[17]=l=>oe.value=l),"max-width":"500"},{default:s(()=>[a(U,null,{default:s(()=>[a(Ue,{class:"d-flex align-center"},{default:s(()=>[a(d,{icon:"mdi-filter-variant",class:"mr-2"}),e[37]||(e[37]=n(" Filter ",-1))]),_:1}),a($e,null,{default:s(()=>[(i(!0),u(T,null,z(I(b).spaces,l=>(i(),u("div",{key:l.id,class:"mb-4"},[p("div",kt,[a(Il,{"model-value":h.value.includes(l.id),"onUpdate:modelValue":r=>ze(l.id),label:l.personal_name||l.name,color:l.personal_color||"primary","hide-details":"",density:"compact"},null,8,["model-value","onUpdate:modelValue","label","color"])]),a(re,null,{default:s(()=>[h.value.includes(l.id)?(i(),u("div",St,[(i(!0),u(T,null,z(Ae(l.id),r=>(i(),u("div",{key:r.id,class:"d-flex align-center"},[a(K,{"model-value":w.value.includes(r.id),"onUpdate:modelValue":S=>We(r.id),color:r.color,"hide-details":"",density:"compact"},{label:s(()=>[a(d,{icon:r.icon||"mdi-tag",color:r.color,size:"small",class:"mr-2"},null,8,["icon","color"]),n(" "+c(r.name),1)]),_:2},1032,["model-value","onUpdate:modelValue","color"])]))),128)),Ae(l.id).length===0?(i(),u("div",Ct," Keine Kategorien ")):v("",!0)])):v("",!0)]),_:2},1024)]))),128))]),_:1}),a(Le,null,{default:s(()=>[a(A,{variant:"text",onClick:qe},{default:s(()=>[...e[38]||(e[38]=[n("Zurücksetzen",-1)])]),_:1}),a(R),a(A,{variant:"text",color:"primary",onClick:e[16]||(e[16]=l=>oe.value=!1)},{default:s(()=>[...e[39]||(e[39]=[n("Fertig",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}},Ft=fl($t,[["__scopeId","data-v-d8f1b305"]]);export{Ft as default};
