import{_ as F,u as L,r,v as D,M as I,c as M,w as a,P,a as E,o as K,b as t,V as R,y as Z,f as V,g as p,h as n,S as $,T as j,W as q,t as _,X as O,R as W,p as m,ac as X,B as G,q as x,i as y,m as S,ad as H,a1 as J,a3 as w,s as C,O as A}from"./index-B5g6srPj.js";const Q={__name:"SettingsViewNew",setup(Y){const h=E(),u=L(),o=r({notification_time:"09:00",digest_filter:"overdue_and_today"}),d=r(!1),f=r(""),v=r("success"),g=r(!1),c=r(!1),i=r({first_name:"",last_name:""}),B=D(()=>{var l,k;const s=((l=u.user)==null?void 0:l.first_name)||"",e=((k=u.user)==null?void 0:k.last_name)||"";return[s,e].filter(Boolean).join(" ")});I(async()=>{u.user&&(o.value.notification_time=u.user.notification_time||"09:00",o.value.digest_filter=u.user.digest_filter||"overdue_and_today")});async function b(){try{const s=await A.patch("/users/settings",o.value);u.user=s.user,f.value="Einstellungen gespeichert",v.value="success",d.value=!0}catch(s){console.error("Failed to save settings:",s),f.value="Fehler beim Speichern",v.value="error",d.value=!0}}function N(){var s,e;i.value.first_name=((s=u.user)==null?void 0:s.first_name)||"",i.value.last_name=((e=u.user)==null?void 0:e.last_name)||"",c.value=!0}async function U(){try{const s=await A.patch("/users/settings",{first_name:i.value.first_name,last_name:i.value.last_name});u.user=s.user,c.value=!1,f.value="Profil gespeichert",v.value="success",d.value=!0}catch(s){console.error("Failed to save profile:",s),f.value="Fehler beim Speichern",v.value="error",d.value=!0}}function T(){g.value=!0}async function z(){g.value=!1,await u.logout(),h.push("/login")}return(s,e)=>(K(),M(P,{class:"bg-background"},{default:a(()=>[t(R,{fluid:"",class:"pa-4"},{default:a(()=>[e[12]||(e[12]=Z("h1",{class:"text-h5 font-weight-bold mb-4"},"Einstellungen",-1)),t(V,{variant:"outlined",class:"mb-3"},{default:a(()=>[t(p,{class:"text-subtitle-1"},{default:a(()=>[...e[9]||(e[9]=[n("Konto",-1)])]),_:1}),t($,{class:"pa-0"},{default:a(()=>[t(j,null,{prepend:a(()=>[t(X,{color:"primary",size:"48"},{default:a(()=>[t(G,{icon:"mdi-account",size:"24"})]),_:1})]),append:a(()=>[t(m,{icon:"mdi-pencil",variant:"text",size:"small",onClick:N})]),default:a(()=>[t(q,{class:"font-weight-medium"},{default:a(()=>[n(_(B.value||"Kein Name"),1)]),_:1}),t(O,null,{default:a(()=>{var l;return[n(_((l=W(u).user)==null?void 0:l.email),1)]}),_:1})]),_:1})]),_:1}),t(x,null,{default:a(()=>[t(m,{block:"",variant:"text",color:"error",onClick:T},{default:a(()=>[...e[10]||(e[10]=[n("Abmelden",-1)])]),_:1})]),_:1})]),_:1}),t(V,{variant:"outlined",class:"mb-3"},{default:a(()=>[t(p,{class:"text-subtitle-1"},{default:a(()=>[...e[11]||(e[11]=[n("Benachrichtigungen",-1)])]),_:1}),t(y,null,{default:a(()=>[t(S,{modelValue:o.value.notification_time,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.notification_time=l),label:"Tägliche Benachrichtigungszeit",type:"time",variant:"outlined",density:"compact","hide-details":"auto",hint:"Uhrzeit für tägliche Zusammenfassung","persistent-hint":"",onBlur:b,onChange:b},null,8,["modelValue"]),t(H,{modelValue:o.value.digest_filter,"onUpdate:modelValue":[e[1]||(e[1]=l=>o.value.digest_filter=l),b],items:[{value:"all",title:"Alle Aufgaben"},{value:"today_only",title:"Nur heute fällige Aufgaben"},{value:"overdue_and_today",title:"Überfällige und heute fällige Aufgaben"}],label:"Zusammenfassung anzeigen",variant:"outlined",density:"compact","hide-details":"",class:"mt-3"},null,8,["modelValue"])]),_:1})]),_:1}),t(J,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),color:v.value,timeout:2e3},{default:a(()=>[n(_(f.value),1)]),_:1},8,["modelValue","color"])]),_:1}),t(w,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),"max-width":"400"},{default:a(()=>[t(V,null,{default:a(()=>[t(p,{class:"text-h6"},{default:a(()=>[...e[13]||(e[13]=[n("Profil bearbeiten",-1)])]),_:1}),t(y,null,{default:a(()=>[t(S,{modelValue:i.value.first_name,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value.first_name=l),label:"Vorname",variant:"outlined",density:"compact","hide-details":"",class:"mb-3"},null,8,["modelValue"]),t(S,{modelValue:i.value.last_name,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.last_name=l),label:"Nachname",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(x,null,{default:a(()=>[t(m,{variant:"text",onClick:e[5]||(e[5]=l=>c.value=!1)},{default:a(()=>[...e[14]||(e[14]=[n("Abbrechen",-1)])]),_:1}),t(C),t(m,{variant:"text",color:"primary",onClick:U},{default:a(()=>[...e[15]||(e[15]=[n("Speichern",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(w,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),"max-width":"400"},{default:a(()=>[t(V,null,{default:a(()=>[t(p,{class:"text-h6"},{default:a(()=>[...e[16]||(e[16]=[n("Abmelden?",-1)])]),_:1}),t(y,null,{default:a(()=>[...e[17]||(e[17]=[n(" Möchten Sie sich wirklich abmelden? ",-1)])]),_:1}),t(x,null,{default:a(()=>[t(C),t(m,{variant:"text",onClick:e[7]||(e[7]=l=>g.value=!1)},{default:a(()=>[...e[18]||(e[18]=[n("Abbrechen",-1)])]),_:1}),t(m,{variant:"text",color:"error",onClick:z},{default:a(()=>[...e[19]||(e[19]=[n("Abmelden",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},te=F(Q,[["__scopeId","data-v-b8bb6ca4"]]);export{te as default};
