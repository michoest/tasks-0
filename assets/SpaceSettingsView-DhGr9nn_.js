import{_ as pe,a9 as fe,r as s,v as ge,x as X,M as be,O as C,c as $,w as t,P as Ve,a as ye,o as u,b as l,V as Ce,y as r,F as w,l as P,p as f,R as ke,t as F,d as he,e as we,Q as xe,G as B,f as z,i as I,m as T,z as Y,s as W,S as Se,H as M,T as _e,W as $e,h as g,B as N,A as D,aa as Z,ab as ee,a0 as ae,L as Fe,g as le,E as ze,q as te,a3 as Ne,a1 as Ke}from"./index-B5g6srPj.js";const Ue={class:"d-flex align-center mb-4"},Be={class:"text-h5 font-weight-bold ml-2"},Ie={key:0,class:"mb-6"},De={key:1,class:"mb-6"},Ee={class:"d-flex align-center mb-3"},Le={class:"d-flex flex-column mr-2"},Pe={class:"mb-6"},Te={class:"d-flex flex-wrap ga-2 mb-2"},Me={class:"mb-3"},Oe={class:"mb-3"},Re={class:"d-flex flex-wrap ga-2"},Ae={__name:"SpaceSettingsView",setup(Ge){const oe=ye(),b=fe().params.id,q=s(!0),x=s(null),v=s([]),k=s(""),E=s(""),h=s(""),V=s(""),S=s(!1),K=s(!1),_=s(null),O=s(null),i=s({name:"",icon:"mdi-tag",color:"blue"}),y=s(""),m=s(""),d=s(!1),c=s(""),p=s("success"),H=ge(()=>{var a;return((a=x.value)==null?void 0:a.role)==="owner"}),Q=["mdi-tag","mdi-home","mdi-cart","mdi-food","mdi-car","mdi-wrench","mdi-school","mdi-heart","mdi-leaf","mdi-dumbbell","mdi-book","mdi-briefcase"],R=["red","pink","purple","deep-purple","indigo","blue","cyan","teal","green","light-green","amber","orange","deep-orange","brown","grey"];X(y,a=>{a&&(i.value.icon="mdi-"+a)}),X(m,a=>{a&&(i.value.color=a)}),be(async()=>{await ne(),await A(),q.value=!1});async function ne(){try{const a=await C.get(`/spaces/${b}`);x.value=a.space,k.value=a.space.name,E.value=a.space.personal_name||"",h.value=a.space.personal_color||"",h.value&&h.value.startsWith("#")&&(V.value=h.value)}catch(a){console.error("Failed to load space:",a)}}async function A(){try{const a=await C.get(`/spaces/${b}/categories`);v.value=a.categories}catch(a){console.error("Failed to load categories:",a)}}async function j(){if(!(!k.value.trim()||k.value===x.value.name))try{await C.patch(`/spaces/${b}`,{name:k.value.trim()}),x.value.name=k.value.trim(),c.value="Name gespeichert",p.value="success",d.value=!0}catch(a){console.error("Failed to save space name:",a),c.value="Fehler beim Speichern",p.value="error",d.value=!0}}function se(){_.value=null,i.value={name:"",icon:"mdi-tag",color:"blue"},y.value="",m.value="",S.value=!0}function re(a){_.value=a,i.value={name:a.name,icon:a.icon,color:a.color},a.icon&&!Q.includes(a.icon)?y.value=a.icon.replace("mdi-",""):y.value="",a.color&&!R.includes(a.color)?m.value=a.color:m.value="",S.value=!0}async function ue(){try{_.value?(await C.patch(`/spaces/${b}/categories/${_.value.id}`,i.value),c.value="Kategorie aktualisiert"):(await C.post(`/spaces/${b}/categories`,i.value),c.value="Kategorie erstellt"),p.value="success",d.value=!0,S.value=!1,await A()}catch(a){console.error("Failed to save category:",a),c.value="Fehler beim Speichern",p.value="error",d.value=!0}}function ie(a){O.value=a,K.value=!0}async function de(){try{await C.delete(`/spaces/${b}/categories/${O.value.id}`),c.value="Kategorie gelöscht",p.value="success",d.value=!0,K.value=!1,await A()}catch(a){console.error("Failed to delete category:",a),c.value="Fehler beim Löschen",p.value="error",d.value=!0}}async function ce(a){if(a===0)return;const e=[...v.value];[e[a-1],e[a]]=[e[a],e[a-1]],v.value=e,await J()}async function ve(a){if(a===v.value.length-1)return;const e=[...v.value];[e[a],e[a+1]]=[e[a+1],e[a]],v.value=e,await J()}async function J(){try{const a=v.value.map(e=>e.id);await C.post(`/spaces/${b}/categories/reorder`,{category_ids:a})}catch(a){console.error("Failed to save category order:",a),c.value="Fehler beim Speichern der Reihenfolge",p.value="error",d.value=!0}}function me(a){h.value=a,V.value="",L()}async function L(){try{const a=V.value||h.value||null;await C.patch(`/spaces/${b}/personal-settings`,{personal_name:E.value||null,personal_color:a}),c.value="Einstellungen gespeichert",p.value="success",d.value=!0}catch(a){console.error("Failed to save personal settings:",a),c.value="Fehler beim Speichern",p.value="error",d.value=!0}}return(a,e)=>(u(),$(Ve,{class:"bg-background"},{default:t(()=>[l(Ce,{fluid:"",class:"pa-4"},{default:t(()=>{var o;return[r("div",Ue,[l(f,{icon:"mdi-arrow-left",variant:"text",onClick:e[0]||(e[0]=n=>ke(oe).back())}),r("h1",Be,F((o=x.value)==null?void 0:o.name),1)]),q.value?(u(),$(he,{key:0},{default:t(()=>[l(we,{cols:"12",class:"text-center py-8"},{default:t(()=>[l(xe,{indeterminate:"",color:"primary"})]),_:1})]),_:1})):x.value?(u(),w(B,{key:1},[H.value?(u(),w("div",Ie,[e[13]||(e[13]=r("h2",{class:"text-h6 font-weight-bold mb-3"},"Space-Einstellungen",-1)),l(z,{elevation:"0"},{default:t(()=>[l(I,null,{default:t(()=>[l(T,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=n=>k.value=n),label:"Space-Name",variant:"outlined","hide-details":"",onBlur:j,onKeyup:Y(j,["enter"])},null,8,["modelValue"])]),_:1})]),_:1})])):P("",!0),H.value?(u(),w("div",De,[r("div",Ee,[e[14]||(e[14]=r("h2",{class:"text-h6 font-weight-bold"},"Kategorien",-1)),l(W),l(f,{icon:"mdi-plus",size:"small",variant:"text",color:"primary",onClick:se})]),v.value.length>0?(u(),$(z,{key:0,elevation:"0"},{default:t(()=>[l(Se,{class:"pa-0"},{default:t(()=>[(u(!0),w(B,null,M(v.value,(n,U)=>(u(),$(_e,{key:n.id,class:"px-4"},{prepend:t(()=>[r("div",Le,[l(f,{icon:"mdi-chevron-up",size:"x-small",variant:"text",disabled:U===0,onClick:G=>ce(U)},null,8,["disabled","onClick"]),l(f,{icon:"mdi-chevron-down",size:"x-small",variant:"text",disabled:U===v.value.length-1,onClick:G=>ve(U)},null,8,["disabled","onClick"])]),l(N,{icon:n.icon,color:n.color,class:"mr-2"},null,8,["icon","color"])]),append:t(()=>[l(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:G=>re(n)},null,8,["onClick"]),l(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:G=>ie(n)},null,8,["onClick"])]),default:t(()=>[l($e,null,{default:t(()=>[g(F(n.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):(u(),$(z,{key:1,elevation:"0"},{default:t(()=>[l(I,{class:"text-center py-8"},{default:t(()=>[l(N,{size:"48",color:"grey-lighten-1"},{default:t(()=>[...e[15]||(e[15]=[g("mdi-tag-off-outline",-1)])]),_:1}),e[16]||(e[16]=r("div",{class:"text-body-2 text-medium-emphasis mt-2"}," Keine Kategorien ",-1))]),_:1})]),_:1}))])):P("",!0),r("div",Pe,[e[18]||(e[18]=r("h2",{class:"text-h6 font-weight-bold mb-3"},"Persönliche Einstellungen",-1)),l(z,{elevation:"0"},{default:t(()=>[l(I,null,{default:t(()=>[l(T,{modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=n=>E.value=n),label:"Eigener Name für diesen Space",variant:"outlined",hint:"Nur für dich sichtbar. Leer lassen für Standardname.","persistent-hint":"",class:"mb-4",onBlur:L,onKeyup:Y(L,["enter"])},null,8,["modelValue"]),e[17]||(e[17]=r("div",{class:"text-caption mb-2"},"Space-Farbe (nur für dich)",-1)),r("div",Te,[(u(),w(B,null,M(R,n=>l(D,{key:n,color:n,variant:h.value===n?"flat":"outlined",size:"small",onClick:U=>me(n)},null,8,["color","variant","onClick"])),64)),l(Z,{"close-on-content-click":!1},{activator:t(({props:n})=>[l(D,ae(n,{size:"small",variant:V.value?"flat":"outlined",style:V.value?{backgroundColor:V.value}:{}}),{default:t(()=>[l(N,{icon:"mdi-palette",size:"small"})]),_:1},16,["variant","style"])]),default:t(()=>[l(ee,{modelValue:V.value,"onUpdate:modelValue":[e[3]||(e[3]=n=>V.value=n),L],mode:"hex","hide-inputs":"","show-swatches":""},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1})])],64)):P("",!0)]}),_:1}),l(Fe,{modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=o=>S.value=o)},{default:t(()=>[l(z,null,{default:t(()=>[l(le,null,{default:t(()=>[g(F(_.value?"Kategorie bearbeiten":"Neue Kategorie"),1)]),_:1}),l(I,null,{default:t(()=>[l(T,{modelValue:i.value.name,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.name=o),label:"Name",variant:"outlined",class:"mb-3"},null,8,["modelValue"]),r("div",Me,[e[20]||(e[20]=r("div",{class:"text-caption mb-2"},"Icon",-1)),l(ze,{modelValue:i.value.icon,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.icon=o),column:"",mandatory:""},{default:t(()=>[(u(),w(B,null,M(Q,o=>l(D,{key:o,value:o,variant:"outlined",filter:""},{default:t(()=>[l(N,{icon:o},null,8,["icon"])]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),l(T,{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=o=>y.value=o),label:"Eigenes Icon",variant:"outlined",density:"compact","hide-details":"",class:"mt-2",placeholder:"home, cart, star..."},{"prepend-inner":t(()=>[...e[19]||(e[19]=[r("span",{class:"text-caption text-medium-emphasis"},"mdi-",-1)])]),"append-inner":t(()=>[y.value?(u(),$(N,{key:0,icon:"mdi-"+y.value},null,8,["icon"])):P("",!0)]),_:1},8,["modelValue"])]),r("div",Oe,[e[21]||(e[21]=r("div",{class:"text-caption mb-2"},"Farbe",-1)),r("div",Re,[(u(),w(B,null,M(R,o=>l(D,{key:o,color:o,variant:i.value.color===o?"flat":"outlined",size:"small",onClick:n=>{i.value.color=o,m.value=""}},null,8,["color","variant","onClick"])),64)),l(Z,{"close-on-content-click":!1},{activator:t(({props:o})=>[l(D,ae(o,{size:"small",variant:m.value?"flat":"outlined",style:m.value?{backgroundColor:m.value}:{}}),{default:t(()=>[l(N,{icon:"mdi-palette",size:"small"})]),_:1},16,["variant","style"])]),default:t(()=>[l(ee,{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=o=>m.value=o),mode:"hex","hide-inputs":"","show-swatches":""},null,8,["modelValue"])]),_:1})])])]),_:1}),l(te,null,{default:t(()=>[l(f,{variant:"text",color:"error",onClick:e[8]||(e[8]=o=>S.value=!1)},{default:t(()=>[...e[22]||(e[22]=[g("Abbrechen",-1)])]),_:1}),l(W),l(f,{variant:"text",color:"primary",onClick:ue},{default:t(()=>[g(F(_.value?"Speichern":"Erstellen"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ne,{modelValue:K.value,"onUpdate:modelValue":e[11]||(e[11]=o=>K.value=o),"max-width":"400"},{default:t(()=>[l(z,null,{default:t(()=>[l(le,{class:"text-h6"},{default:t(()=>[...e[23]||(e[23]=[g("Kategorie löschen?",-1)])]),_:1}),l(I,null,{default:t(()=>{var o;return[g(' Möchten Sie "'+F((o=O.value)==null?void 0:o.name)+'" wirklich löschen? ',1)]}),_:1}),l(te,null,{default:t(()=>[l(W),l(f,{variant:"text",onClick:e[10]||(e[10]=o=>K.value=!1)},{default:t(()=>[...e[24]||(e[24]=[g("Abbrechen",-1)])]),_:1}),l(f,{variant:"text",color:"error",onClick:de},{default:t(()=>[...e[25]||(e[25]=[g("Löschen",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ke,{modelValue:d.value,"onUpdate:modelValue":e[12]||(e[12]=o=>d.value=o),timeout:2e3,color:p.value,location:"top"},{default:t(()=>[g(F(c.value),1)]),_:1},8,["modelValue","color"])]),_:1}))}},He=pe(Ae,[["__scopeId","data-v-4ed3cf7a"]]);export{He as default};
